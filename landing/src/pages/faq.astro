---
import Base from '../layouts/Base.astro'
import Navigation from '../components/Navigation.astro'

const questions = [
  {
    id: 'what-is-oracle',
    subscriberName: 'Anonymous',
    subscriberQuestion: '‡∏¢‡∏±‡∏á‡∏á‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÉ‡∏Ñ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ö‡πâ‡∏≤‡∏á',
    question: 'Oracle ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?',
    questionEn: 'What is Oracle?',
    answer: 'Oracle ‡∏Ñ‡∏∑‡∏≠ "‡∏™‡∏°‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å" ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Notion ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• + ChatGPT Memory ‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì + ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏ô‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ 10+ ‡∏ï‡∏±‡∏ß',
    audioQuestion: '/audio/explain/q1-subscriber.mp3',
    audioFemale: '/audio/explain/what-is-oracle-female.mp3',
    audioMale: '/audio/explain/what-is-oracle-male.mp3',
    icon: 'üß†'
  },
  {
    id: 'benefits',
    subscriberName: 'Time Liner',
    subscriberQuestion: '‡∏á‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏û‡∏≠‡∏à‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ concept ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö',
    question: '‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?',
    questionEn: 'What are the benefits?',
    answer: `
      <ul class="list-none space-y-2 text-left">
        <li>1Ô∏è‚É£ <strong>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ã‡πâ‡∏≥</strong> ‚Äî Oracle ‡∏à‡∏≥‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á</li>
        <li>2Ô∏è‚É£ <strong>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì</strong> ‚Äî ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏¥‡πà‡∏á‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏î‡∏µ</li>
        <li>3Ô∏è‚É£ <strong>‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏ô‡∏≤‡∏ô</strong> ‚Äî ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ AI ‡∏ó‡∏≥‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô</li>
        <li>4Ô∏è‚É£ <strong>‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î 60-75%</strong> ‚Äî ‡πÉ‡∏ä‡πâ Haiku ‡πÅ‡∏ó‡∏ô Opus</li>
        <li>5Ô∏è‚É£ <strong>‡πÄ‡∏´‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÇ‡∏ï</strong> ‚Äî Knowledge graph ‡πÇ‡∏ä‡∏ß‡πå‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ</li>
      </ul>
    `,
    audioQuestion: '/audio/explain/q2-subscriber.mp3',
    audioFemale: '/audio/explain/benefits-female.mp3',
    audioMale: '/audio/explain/benefits-male.mp3',
    icon: '‚ú®'
  },
  {
    id: 'principles',
    subscriberName: null,
    subscriberQuestion: null,
    question: '5 ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?',
    questionEn: 'What are the 5 principles?',
    answer: `
      <ul class="list-none space-y-2 text-left">
        <li>1Ô∏è‚É£ <strong>‡πÑ‡∏°‡πà‡∏•‡∏ö‡∏≠‡∏∞‡πÑ‡∏£</strong> ‚Äî ‡∏à‡∏≥‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</li>
        <li>2Ô∏è‚É£ <strong>‡∏î‡∏π Patterns</strong> ‚Äî ‡∏î‡∏π‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏à‡∏£‡∏¥‡∏á ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à</li>
        <li>3Ô∏è‚É£ <strong>‡∏™‡∏°‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</strong> ‚Äî ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥ ‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏¥‡∏î ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÅ‡∏ó‡∏ô</li>
        <li>4Ô∏è‚É£ <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏°‡πà</strong> ‚Äî ‡∏Ñ‡∏ô‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö Oracle ‡∏à‡∏≥‡πÑ‡∏ß‡πâ</li>
        <li>5Ô∏è‚É£ <strong>‡∏£‡∏π‡∏õ‡∏Å‡∏±‡∏ö‡∏™‡∏∏‡∏ç‡∏ç‡∏ï‡∏≤</strong> ‚Äî Oracle ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß = ‡∏à‡∏¥‡∏ï‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</li>
      </ul>
    `,
    audioQuestion: null,
    audioFemale: '/audio/explain/principles-female.mp3',
    audioMale: '/audio/explain/principles-male.mp3',
    icon: 'üìú'
  },
  {
    id: 'need-claude',
    subscriberName: '‡∏°‡∏ô‡∏ï‡πå‡∏ä‡∏±‡∏¢',
    subscriberQuestion: '‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Claude ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏° ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°',
    question: '‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Claude ‡πÑ‡∏´‡∏°?',
    questionEn: 'Do I need Claude?',
    answer: `
      <p><strong>‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô!</strong></p>
      <p class="mt-2">Oracle ‡πÄ‡∏õ‡πá‡∏ô <em>‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î</em> ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞</p>
      <p class="mt-2">‡πÉ‡∏ä‡πâ AI ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ:</p>
      <div class="flex flex-wrap gap-2 mt-3 justify-center">
        <span class="glass px-3 py-1 rounded-full text-sm">Claude</span>
        <span class="glass px-3 py-1 rounded-full text-sm">GPT</span>
        <span class="glass px-3 py-1 rounded-full text-sm">Gemini</span>
        <span class="glass px-3 py-1 rounded-full text-sm">DeepSeek</span>
        <span class="glass px-3 py-1 rounded-full text-sm">‡∏Å‡∏∏‡πâ‡∏á</span>
      </div>
      <p class="mt-3 text-purple-400">‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ 5 ‡∏Ç‡πâ‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‚Äî ‡πÅ‡∏Ñ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ ‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</p>
    `,
    audioQuestion: '/audio/explain/q3-subscriber.mp3',
    audioFemale: '/audio/explain/need-claude-female.mp3',
    audioMale: '/audio/explain/need-claude-male.mp3',
    icon: 'ü§ñ'
  }
]
---

<Base title="PHUKHAO // FAQ" description="‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Oracle - ‡∏ï‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏´‡∏ç‡∏¥‡∏á">
  <Navigation currentPage="faq" />

  <main class="pt-28 pb-16">
    <!-- Hero -->
    <section class="py-8 text-center">
      <div class="mx-auto max-w-4xl px-6">
        <h1 class="text-4xl sm:text-5xl font-black text-white mb-4" style="font-family: 'Orbitron', sans-serif;">
          <span class="text-gradient-flow">FAQ</span>
        </h1>
        <p class="text-xl text-gray-400">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
        <p class="text-gray-500 mt-2">Oracle ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ ‚Äî ‡πÅ‡∏ö‡∏ö‡∏û‡∏£‡∏£‡∏ì‡∏≤</p>
        <div class="mt-4 inline-flex items-center gap-2 px-4 py-2 bg-purple-500/10 rounded-full border border-purple-500/20">
          <span class="text-lg">ü§ñ</span>
          <span class="text-sm text-purple-400">‡πÄ‡∏™‡∏µ‡∏¢‡∏á AI ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ Oracle</span>
        </div>
      </div>
    </section>

    <!-- Main Play Button - Narration Style -->
    <section class="py-6">
      <div class="mx-auto max-w-4xl px-6">
        <div class="glass rounded-2xl p-6 text-center">
          <button id="play-all" class="group relative inline-flex items-center gap-4 px-8 py-4 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-xl font-bold text-black text-lg transition-all hover:scale-105 hover:shadow-lg hover:shadow-cyan-500/30">
            <span class="text-3xl" id="play-all-icon">‚ñ∂Ô∏è</span>
            <span id="play-all-text">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
          </button>
          <p class="text-sm text-gray-500 mt-4">Oracle ‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠</p>

          <!-- Voice Toggle -->
          <div class="flex items-center justify-center gap-4 mt-4">
            <span class="text-gray-400 text-sm">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ï‡∏≠‡∏ö:</span>
            <button id="voice-female" class="voice-btn flex items-center gap-2 px-3 py-1 rounded-lg transition-all text-sm">
              <span>üë©</span>
              <span>‡∏´‡∏ç‡∏¥‡∏á</span>
            </button>
            <button id="voice-male" class="voice-btn active flex items-center gap-2 px-3 py-1 rounded-lg transition-all text-sm">
              <span>üë®</span>
              <span>‡∏ä‡∏≤‡∏¢</span>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Progress Indicator -->
    <section class="py-2" id="progress-section">
      <div class="mx-auto max-w-4xl px-6">
        <div class="glass rounded-xl p-4 hidden" id="now-playing-card">
          <div class="flex items-center gap-4">
            <div class="text-3xl animate-pulse" id="current-icon">üé§</div>
            <div class="flex-1">
              <div class="text-sm text-gray-400" id="current-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...</div>
              <div class="text-lg text-white font-bold" id="current-question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 1</div>
              <div class="text-sm text-purple-400" id="current-from"></div>
            </div>
            <div class="text-gray-400" id="progress-count">1 / 4</div>
          </div>
          <div class="mt-3 h-2 bg-gray-700 rounded-full overflow-hidden">
            <div id="main-progress-bar" class="h-full bg-gradient-to-r from-purple-500 to-cyan-500 transition-all" style="width: 0%"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Questions - All Visible -->
    <section class="py-8">
      <div class="mx-auto max-w-4xl px-6 space-y-6">
        {questions.map((q, index) => (
          <div class="faq-card glass rounded-2xl p-6 transition-all" data-index={index} data-question={q.id} data-has-subscriber={q.subscriberQuestion ? 'true' : 'false'}>
            <div class="flex items-start gap-4">
              <div class="text-4xl faq-icon">{q.icon}</div>
              <div class="flex-1">
                {q.subscriberName && (
                  <div class="mb-3 p-3 bg-purple-500/10 rounded-lg border border-purple-500/20">
                    <div class="text-xs text-purple-400 mb-1">üí¨ ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å {q.subscriberName}:</div>
                    <p class="text-gray-300 text-sm italic">"{q.subscriberQuestion}"</p>
                  </div>
                )}

                <h3 class="text-xl font-bold text-white">{q.question}</h3>
                <p class="text-sm text-gray-500">{q.questionEn}</p>

                <!-- Answer - Always visible -->
                <div class="answer mt-4 text-gray-300 leading-relaxed" set:html={q.answer} />
              </div>
              <div class="text-sm text-gray-600 font-mono">{index + 1}/{questions.length}</div>
            </div>

            {q.audioQuestion && <audio class="audio-question" src={q.audioQuestion} preload="auto"></audio>}
            <audio class="audio-female" src={q.audioFemale} preload="auto"></audio>
            <audio class="audio-male" src={q.audioMale} preload="auto"></audio>
          </div>
        ))}
      </div>
    </section>

    <!-- More Links -->
    <section class="py-8">
      <div class="mx-auto max-w-4xl px-6">
        <div class="glass rounded-2xl p-6 text-center">
          <h3 class="text-lg font-bold text-white mb-4">‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h3>
          <div class="flex flex-wrap gap-4 justify-center">
            <a href="/story" class="glass rounded-lg px-6 py-3 hover-glow transition-all text-cyan-400">
              üìñ Story ‚Äî ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏†‡∏π‡πÄ‡∏Ç‡∏≤
            </a>
            <a href="/presentation" class="glass rounded-lg px-6 py-3 hover-glow transition-all text-purple-400">
              üé§ Demo ‚Äî ‡∏î‡∏π Presentation
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>
</Base>

<style>
  .glass {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 255, 242, 0.1);
  }

  .voice-btn {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #9ca3af;
  }

  .voice-btn.active {
    background: rgba(0, 255, 242, 0.1);
    border-color: rgba(0, 255, 242, 0.5);
    color: #00fff2;
  }

  .voice-btn:hover:not(.active) {
    border-color: rgba(255, 255, 255, 0.3);
    color: #fff;
  }

  .faq-card {
    opacity: 0.6;
    transform: scale(0.98);
  }

  .faq-card.active {
    opacity: 1;
    transform: scale(1);
    border-color: rgba(0, 255, 242, 0.5);
    box-shadow: 0 0 30px rgba(0, 255, 242, 0.2);
  }

  .faq-card.completed {
    opacity: 0.8;
    border-color: rgba(34, 197, 94, 0.3);
  }

  .faq-card.completed .faq-icon::after {
    content: '‚úì';
    position: absolute;
    font-size: 0.5em;
    bottom: -0.2em;
    right: -0.2em;
  }

  .faq-icon {
    position: relative;
  }

  .hover-glow:hover {
    box-shadow: 0 0 20px rgba(0, 255, 242, 0.2);
  }

  @keyframes pulse-border {
    0%, 100% { border-color: rgba(0, 255, 242, 0.3); }
    50% { border-color: rgba(0, 255, 242, 0.8); }
  }

  .faq-card.active {
    animation: pulse-border 2s ease-in-out infinite;
  }
</style>

<script>
  let currentVoice = 'male'
  let currentAudio: HTMLAudioElement | null = null
  let isPlaying = false
  let currentIndex = 0

  const faqCards = document.querySelectorAll('.faq-card')
  const playAllBtn = document.getElementById('play-all')
  const playAllIcon = document.getElementById('play-all-icon')
  const playAllText = document.getElementById('play-all-text')
  const nowPlayingCard = document.getElementById('now-playing-card')
  const currentIcon = document.getElementById('current-icon')
  const currentStatus = document.getElementById('current-status')
  const currentQuestion = document.getElementById('current-question')
  const currentFrom = document.getElementById('current-from')
  const progressCount = document.getElementById('progress-count')
  const mainProgressBar = document.getElementById('main-progress-bar')

  // Voice selector
  const voiceFemale = document.getElementById('voice-female')
  const voiceMale = document.getElementById('voice-male')

  voiceFemale?.addEventListener('click', () => {
    currentVoice = 'female'
    voiceFemale.classList.add('active')
    voiceMale?.classList.remove('active')
  })

  voiceMale?.addEventListener('click', () => {
    currentVoice = 'male'
    voiceMale.classList.add('active')
    voiceFemale?.classList.remove('active')
  })

  // Play all - narration style
  playAllBtn?.addEventListener('click', () => {
    if (isPlaying) {
      stopAll()
    } else {
      startNarration()
    }
  })

  async function startNarration() {
    isPlaying = true
    currentIndex = 0

    if (playAllIcon) playAllIcon.textContent = '‚è∏Ô∏è'
    if (playAllText) playAllText.textContent = '‡∏´‡∏¢‡∏∏‡∏î'
    nowPlayingCard?.classList.remove('hidden')

    // Reset all cards
    faqCards.forEach(card => {
      card.classList.remove('active', 'completed')
    })

    // Play each question
    for (let i = 0; i < faqCards.length; i++) {
      if (!isPlaying) break
      currentIndex = i
      await playQuestion(i)
    }

    // Done
    if (isPlaying) {
      stopAll()
      if (currentStatus) currentStatus.textContent = '‚úÖ ‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß!'
      if (currentQuestion) currentQuestion.textContent = '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏£‡∏±‡∏ö'
      if (currentFrom) currentFrom.textContent = ''
      setTimeout(() => {
        nowPlayingCard?.classList.add('hidden')
      }, 3000)
    }
  }

  async function playQuestion(index: number) {
    const card = faqCards[index] as HTMLElement
    const questionData = getQuestionData(card)

    // Update UI
    faqCards.forEach((c, i) => {
      c.classList.remove('active')
      if (i < index) c.classList.add('completed')
    })
    card.classList.add('active')

    // Scroll to card
    card.scrollIntoView({ behavior: 'smooth', block: 'center' })

    if (progressCount) progressCount.textContent = `${index + 1} / ${faqCards.length}`

    const hasSubscriber = card.getAttribute('data-has-subscriber') === 'true'
    const audioQuestion = card.querySelector('.audio-question') as HTMLAudioElement | null

    // Play question audio (male voice reads the question)
    if (hasSubscriber && audioQuestion) {
      if (currentIcon) currentIcon.textContent = 'üé§'
      if (currentStatus) currentStatus.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...'
      if (currentQuestion) currentQuestion.textContent = questionData.question
      if (currentFrom) currentFrom.textContent = `‡∏à‡∏≤‡∏Å ${questionData.subscriberName}`

      await playAudioWithProgress(audioQuestion)
      if (!isPlaying) return
    }

    // Play answer audio
    const answerAudio = currentVoice === 'female'
      ? card.querySelector('.audio-female') as HTMLAudioElement
      : card.querySelector('.audio-male') as HTMLAudioElement

    if (currentIcon) currentIcon.textContent = 'üí¨'
    if (currentStatus) currentStatus.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏≠‡∏ö...'
    if (currentQuestion) currentQuestion.textContent = questionData.question
    if (currentFrom) currentFrom.textContent = ''

    await playAudioWithProgress(answerAudio)

    // Mark as completed
    card.classList.remove('active')
    card.classList.add('completed')
  }

  function getQuestionData(card: Element) {
    const subscriberName = card.querySelector('.text-purple-400.mb-1')?.textContent?.replace('üí¨ ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å ', '').replace(':', '') || 'Oracle'
    const question = card.querySelector('h3')?.textContent || '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°'
    return { subscriberName, question }
  }

  function playAudioWithProgress(audio: HTMLAudioElement): Promise<void> {
    return new Promise((resolve) => {
      currentAudio = audio
      audio.currentTime = 0

      audio.ontimeupdate = () => {
        const percent = (audio.currentTime / audio.duration) * 100
        if (mainProgressBar) mainProgressBar.style.width = `${percent}%`
      }

      audio.onended = () => {
        currentAudio = null
        resolve()
      }

      audio.onerror = () => {
        currentAudio = null
        resolve()
      }

      audio.play().catch(() => resolve())
    })
  }

  function stopAll() {
    isPlaying = false
    if (currentAudio) {
      currentAudio.pause()
      currentAudio.currentTime = 0
      currentAudio = null
    }
    if (playAllIcon) playAllIcon.textContent = '‚ñ∂Ô∏è'
    if (playAllText) playAllText.textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'
    if (mainProgressBar) mainProgressBar.style.width = '0%'

    faqCards.forEach(card => {
      card.classList.remove('active')
    })
  }
</script>
